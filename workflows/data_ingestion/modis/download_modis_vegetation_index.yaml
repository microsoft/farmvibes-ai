name: download_modis_vegetation_index
sources:
  user_input:
    - list.input_data
sinks:
  index: download.index
parameters:
  index:
  pc_key:
  resolution_m:
tasks:
  list:
    op: list_modis_vegetation
    parameters:
      resolution: "@from(resolution_m)"
  download:
    op: download_modis_vegetation
    parameters:
      pc_key: "@from(pc_key)"
      index: "@from(index)"
edges:
  - origin: list.modis_products
    destination:
      - download.product
description:
  short_description:
    Downloads MODIS 16-day vegetation index products that intersect with the input geometry and time
    range.
  long_description:
    The workflow will download products at the chosen index and resolution. The products are
    available at a 16-day interval and pixel values are selected based on low clouds, low view
    angle, and highest index value. Vegetation index values range from (-2000 to 10000).
    For more information, see https://planetarycomputer.microsoft.com/dataset/modis-13Q1-061
    and https://lpdaac.usgs.gov/products/mod13a1v061/ .  
  sources:
    user_input: Time range and geometry of interest.
  sinks:
    index: Products containing the chosen index at the chosen resolution.
  parameters:
    index: Vegetation index that should be downloaded. Either 'evi' or 'ndvi'.
    pc_key: Optional Planetary Computer API key.
    resolution_m: Product resolution, in meters. Either 250 or 500.
